## 어떤 벡터 DB를 쓸까?

- 벡터 DB에서 메타데이터 관리하기
    
    ⇒ 문서 내용, 문서 ID, 문장 ID, 카테고리 컬럼 정도로?
    

### **[FAISS 사용하는 경우]**

⇒ FAISS는 벡터 검색을 위한 라이브러리. DB가 아님 !

1. 문서 DB에서 회의에서 사용할 문서가 필터링 됨
2. 문서를 문장 단위로 나눠서 임베딩
3. 임베딩 벡터는 문서 ID와 함께 벡터 DB에 저장
4. FAISS 인덱스에 벡터 데이터를 로드해서 추가
5. 사용자가 젯슨에게 질문함
6. 질문 내용을 임베딩 ⇒ 질문 벡터 생성
7. 질문 벡터를 FAISS 인덱스에 검색 요청
8. FAISS가 유사도 계산해서 가까운 결과(유사한 문장)에 대한 벡터 ID 반환
9. 반환된 벡터 ID에 해당하는 문장과 문서 ID를, 벡터 DB or 메타데이터에서 추출
10. 원본 DB에서, 추출된 문장이 들어있던 문서를 불러온 후, 추출된 문장 부분을 하이라이팅

참고

- FAISS가 유사도 계산해서 반환하는 내용
    
    : distances(거리), indices(인덱스)
    
    ```
    distances = [[0.12, 0.34, 0.56]]  # 1차원 배열, Top-K 검색 결과
    indices = [[0, 2, 5]]             # 1차원 배열, Top-K에 해당하는 벡터 ID
    ```

#

### **[Milvus DB사용하는 경우]**

1. 문서 DB에서 회의에서 사용할 문서가 필터링 됨
2. 문서를 문장 단위로 나눠서 임베딩
3. 임베딩 벡터와 메타데이터(문장 내용, 문서 ID)를 Milvus에 저장
4. 사용자가 젯슨에게 질문함
5. 질문 내용을 임베딩 ⇒ 질문 벡터 생성
6. 질문 벡터를 Milvus DB에 검색 요청
7. Milvus DB에서 유사도 계산해서 유사한 문장 내용과 문서 ID를 반환
8. 원본 DB에서, 반환된 문서 ID에 해당하는 문서 불러오기
9. 반환된 문장을, 불러온 문서에서 매칭하여 하이라이팅

참고

- Milvus가 유사도 계산해서 반환하는 내용
    
    : distances(거리), entitles(메타데이터 ⇒ 문장 내용과 문서 ID 포함되어 있을 것임)
    
    ```
    distances = [0.12, 0.34, 0.56]   # Top-K 검색 결과의 거리
    entities = [
        {"sentence": "강아지가 귀엽다", "document_id": "doc1"},
        {"sentence": "고양이는 사랑스럽다", "document_id": "doc1"},
        {"sentence": "햇살이 따뜻하다", "document_id": "doc2"}
    ]
    ```
#

### **[Chroma DB 사용하는 경우]**

*—이미 저장되어 있는 문서라면*

1. 문서 DB에서 회의에서 사용할 문서가 필터링 됨
2. 문서를 문장 단위로 나누고, 각 문장을 임베딩해서 Chroma DB에 저장 ⇒ 벡터, 문장 내용, 문서 ID가 저장될 것임

*—회의 내용 녹음하고 있는 경우*

1. 회의 내용 STT로 문장 단위로 원본 DB에 쌓는 중
2. 사용자가 젯슨에게 질문함
3. 질문 내용을 임베딩 ⇒ 질문 벡터 생성
4. Chroma DB에서 질문 벡터와 유사도 계산해서, 유사한 문장 내용과 문서 ID를 반환
5. 원본 DB에서, 반환된 문서 ID에 해당하는 문서 불러오기
6. 반환된 문장을, 불러온 문서에서 매칭하여 하이라이팅해서 보여주기

참고

- Chroma DB가 유사도 계산해서 반환하는 내용
    
    : distances(거리), documents(문장 내용), metadatas(메타데이터 ⇒ 문서 ID 들어 있을 것임)
    
    ```
    [
      {
        "distance": 0.1234,
        "document": "강아지가 귀엽다",
        "metadata": {
          "document_id": "doc1",
          "sentence_id": "doc1_sent1"
        }
      },
      {
        "distance": 0.4567,
        "document": "고양이는 사랑스럽다",
        "metadata": {
          "document_id": "doc1",
          "sentence_id": "doc1_sent2"
        }
      }
    ]
    
    ```